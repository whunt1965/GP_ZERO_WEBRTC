import frida
import sys


package_name = "org.thoughtcrime.securesms"

def get_messages_from_js(message, data):
            #print(message)
            #print (message['payload'])
            print("")
 


devices = frida.enumerate_devices()
device = 0

if len(sys.argv) < 2:
	print("Please specify device of:")
	for item in devices:
		print(item.name)
	exit()	

for item in devices:
	#print(item.name)
	if sys.argv[1] == item.name:
		device = item


process = device.attach(package_name)
code = open('exploit.js', 'r').read()
script = process.create_script(code)
script.on('message',get_messages_from_js)
script.load()
sys.stdin.read()
